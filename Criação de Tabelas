IF OBJECT_ID('TB_ECHO_WMS_STATUS_CONTROLE') IS NULL
BEGIN
	CREATE TABLE
		DBO.TB_ECHO_WMS_STATUS_CONTROLE
		(STATUS INT PRIMARY KEY,
		 DETALHE VARCHAR(100)
		)

	INSERT INTO 
		DBO.TB_ECHO_WMS_STATUS_CONTROLE
	SELECT 0, 'Linx - Pendente Processamento'	UNION ALL
	SELECT 1, 'Linx - Faturamento Gerado'		UNION ALL
	SELECT 2, 'WMS - Aguardando Despacho'		UNION ALL
	SELECT 3, 'WMS - Aguardando Picking'		UNION ALL
	SELECT 4, 'WMS - Despachado'				UNION ALL
	SELECT 5, 'WMS - Picking Concluido'			UNION ALL
	SELECT 8, 'Historico'						UNION ALL
	SELECT 9, 'Linx	- Erro Integracao'		

END

IF OBJECT_ID('TB_ECHO_WMS_CONTROLE') IS NULL
BEGIN
	CREATE TABLE
		DBO.TB_ECHO_WMS_CONTROLE
		(ID BIGINT IDENTITY NOT NULL PRIMARY KEY,
			FILIAL VARCHAR(25) NOT NULL,
			CLIENTE VARCHAR(25) NOT NULL,
			ORIGEM VARCHAR(50) NOT NULL,
			CHAVE VARCHAR(150) NOT NULL,
			STATUS  INT NOT NULL,
			STATUS_ANTERIOR INT NULL,
			DATA_HORA_GERACAO DATETIME NOT NULL,
			DATA_HORA_UPDATE  DATETIME NOT NULL,
			USUARIO			VARCHAR(254)  NULL,
			HOST			VARCHAR(254)  NULL,
			APP_EXEC		VARCHAR(254)  NULL,
			SAIDA_NF		VARCHAR(15) NULL,
			SAIDA_SERIE		VARCHAR(6) NULL,
			TRANSF_NF		VARCHAR(15) NULL,
			TRANSF_SERIE	VARCHAR(6) NULL,
			DATA_PICKING_ENVIO DATETIME NULL,
			DATA_PICKING_CONCLUIDO DATETIME NULL,
			DATA_FATURADO		DATETIME NULL,
			DATA_DESPACHADO DATETIME NULL
		)
		
		CREATE INDEX [IX1_TB_ECHO_WMS_CONTROLE] ON [dbo].[TB_ECHO_WMS_CONTROLE] ([ORIGEM])
		CREATE INDEX [IX2_TB_ECHO_WMS_CONTROLE] ON [dbo].[TB_ECHO_WMS_CONTROLE] ([ORIGEM],[CHAVE])
		CREATE INDEX [IX3_TB_ECHO_WMS_CONTROLE] ON [dbo].[TB_ECHO_WMS_CONTROLE] ([CHAVE])
		CREATE INDEX [IX4_TB_ECHO_WMS_CONTROLE] ON [dbo].[TB_ECHO_WMS_CONTROLE] ([ORIGEM],[STATUS])
		CREATE INDEX [IX5_TB_ECHO_WMS_CONTROLE] ON [dbo].[TB_ECHO_WMS_CONTROLE] ([STATUS])
		CREATE INDEX [IX6_TB_ECHO_WMS_CONTROLE] ON [dbo].[TB_ECHO_WMS_CONTROLE] (FILIAL)
		CREATE INDEX [IX7_TB_ECHO_WMS_CONTROLE] ON [dbo].[TB_ECHO_WMS_CONTROLE] (FILIAL,[STATUS])
		CREATE INDEX [IX8_TB_ECHO_WMS_CONTROLE] ON [dbo].[TB_ECHO_WMS_CONTROLE] (FILIAL,CHAVE)
		CREATE INDEX [IX9_TB_ECHO_WMS_CONTROLE] ON [dbo].[TB_ECHO_WMS_CONTROLE] ([ORIGEM],STATUS_ANTERIOR)
		CREATE INDEX [IX10_TB_ECHO_WMS_CONTROLE] ON [dbo].[TB_ECHO_WMS_CONTROLE] (STATUS_ANTERIOR)
		CREATE INDEX [IX11_TB_ECHO_WMS_CONTROLE] ON [dbo].[TB_ECHO_WMS_CONTROLE] (FILIAL,STATUS_ANTERIOR)
		CREATE INDEX [IX12_TB_ECHO_WMS_CONTROLE] ON [dbo].[TB_ECHO_WMS_CONTROLE] (TRANSF_NF)

END

IF OBJECT_ID('TB_ECHO_WMS_CONTROLE_LOGS') IS NULL
BEGIN
	CREATE TABLE
		DBO.TB_ECHO_WMS_CONTROLE_LOGS
		(ID BIGINT NOT NULL,
		 ITEM INT NOT NULL,
		 ORIGEM VARCHAR(254) NOT NULL,
		 DETALHES VARCHAR(254) NOT NULL
	 CONSTRAINT [XPKTB_ECHO_WMS_CONTROLE_LOGS] PRIMARY KEY CLUSTERED 
	(
		ID, ITEM
	)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = ON, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
	) ON [PRIMARY]
		
	CREATE INDEX [IX1_TB_ECHO_WMS_CONTROLE_LOGS] ON [dbo].[TB_ECHO_WMS_CONTROLE_LOGS] ([ID])
END


IF OBJECT_ID('TB_ECHO_WMS_CONTROLE_STATUS') IS NULL
BEGIN
	CREATE TABLE
		DBO.TB_ECHO_WMS_CONTROLE_STATUS
		(ID_LOG BIGINT IDENTITY NOT NULL,
		 ID BIGINT NOT NULL,
		 CHAVE VARCHAR(150) NOT NULL,
		 STATUS INT NOT NULL,
		 DATA_HORA DATETIME NOT NULL
	 CONSTRAINT [XPKTB_ECHO_WMS_CONTROLE_STATUS] PRIMARY KEY CLUSTERED 
	(
		ID_LOG
	)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = ON, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
	) ON [PRIMARY]
		
	CREATE INDEX [IX1_TB_ECHO_WMS_CONTROLE_STATUS] ON [dbo].[TB_ECHO_WMS_CONTROLE_STATUS] ([ID])
END
